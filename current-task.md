## Implementation Guide: Implement keystroke injection via `CGEvent` with clipboard fallback

- [x] Verify `pyproject.toml` still declares `pyobjc-core`, `pyobjc-framework-Cocoa`, `pyobjc-framework-ApplicationServices`, and `pyobjc-framework-Quartz`; if any are missing or pinned incorrectly for local macOS, run `poetry add ...` and `poetry install` to ensure `CGEvent` and `NSPasteboard` bindings import cleanly.
- [x] Add a new module `src/whisper_input_mac/text_injector.py` with a `TextInjectionError` exception, a `KeyboardInjector` class encapsulating CGEvent logic, and a `ClipboardFallback` helper; export a top-level `TextInjector` fa√ßade that coordinates both paths.
- [x] Inside `KeyboardInjector`, implement `ensure_trusted_access()` that calls `Quartz.AXIsProcessTrustedWithOptions` mirroring the focus observer pattern; raise `TextInjectionError` when trust is missing so the orchestrator can degrade gracefully.
- [x] Implement `KeyboardInjector.send_unicode(text: str)` by creating a single key-down/keyup pair via `Quartz.CGEventCreateKeyboardEvent`, invoke `Quartz.CGEventKeyboardSetUnicodeString`, and post to `kCGHIDEventTap`; guard against empty strings and wrap PyObjC errors to add context.
- [x] Flesh out `ClipboardFallback.paste_text(text: str)` to write the text to `NSPasteboard`, issue a Command+V pair via `CGEventCreateKeyboardEvent`, and optionally restore the previous clipboard contents; log whether the fallback succeeded or if accessibility prevented the keystroke.
- [x] Extend `TextInjector.send_text(text, prefer_clipboard: bool = False)` to try keystroke injection first when trusted, fall back to clipboard on exceptions, and surface a boolean/report for the orchestrator to emit success or error callbacks.
- [x] Update `src/whisper_input_mac/orchestrator.py` to instantiate `TextInjector`, replace `_paste_to_clipboard` usage with the new API, and emit structured success/error events so downstream components can display notifications when injection fails.
- [x] Add unit tests under `tests/text_injection/test_text_injector.py` that monkeypatch Quartz/Cocoa symbols to validate the control flow for trusted/untrusted states, keystroke exceptions, and clipboard fallback; run `poetry run pytest tests/text_injection/test_text_injector.py`.
- [x] Create a manual verification script `src/whisper_input_mac/tools/debug_injection.py` that calls `TextInjector.send_text("Hello from Whisper Input")` while a text field is focused; document the expected accessibility prompts and fallback behavior in `docs/manual-testing.md`.
